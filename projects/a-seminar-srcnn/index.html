<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Image Super Resolution using CNN - in Lasagne on jupyter notebook &middot; Aditya Ganeshan
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/w3.css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <link href="https://fonts.googleapis.com/css?family=Raleway|Roboto" rel="stylesheet">
</head>


  <body
    style="background-color:#f9f9f9;
      background-image: url(/img/bckgd_body.png);
      background-repeat: repeat;
      background-attachment: fixed;">

      
        <div class="sidebar w3-card">
  <div class="container sidebar-sticky sidebar-sticky-up ">

      <div class="sidebar-about ">
      
      <h3>
        <a href="/"  >
          Aditya Ganeshan
        </a>
      </h3>
      
    </div>

    <ul class = "sidebar-menu sidebar-top-border">
    <li class="sidebar-menu__item sidebar-menu__item--0
       ">
      <a href="/">Home</a>
    </li>

    <li class="sidebar-menu__item sidebar-menu__item--0
      
      sidebar-menu__item--expanded sidebar-menu__item--active
       ">
      <a href="/projects/">Projects</a>
    </li>
      

      
<li class='sidebar-menu__submenu  no-bullet'>
<ul class="in-page-menu sidebar-menu">
        <li class="sidebar-menu__item sidebar-menu__item--1 font_bold">
        <a  href="">Image Super Resolution using CNN - in Lasagne on jupyter notebook</a>
        </li>
        <li class='sidebar-menu__submenu  no-bullet'>
<ul class="in-page-menu sidebar-menu">
    
      
        
        <li class="sidebar-menu__item sidebar-menu__item--2">
        <a  href="#introduction">Introduction</a>
        </li>
        
      
        
        <li class="sidebar-menu__item sidebar-menu__item--2">
        <a  href="#introduction-to-image-super-resolution">Introduction to Image Super-Resolution</a>
        </li>
        
      
        
        <li class="sidebar-menu__item sidebar-menu__item--2">
        <a  href="#the-model">The Model</a>
        </li>
        
      
        
        <li class="sidebar-menu__item sidebar-menu__item--2">
        <a  href="#training">Training</a>
        </li>
        
      
        
        <li class="sidebar-menu__item sidebar-menu__item--2">
        <a  href="#links">Links</a>
        </li>
        
      
    
</ul>
</li>

</ul>
</li>
      
    <li class="sidebar-menu__item sidebar-menu__item--0
       ">
      <a href="/blog/">Blog</a>
    </li>
      
      
    <li class="sidebar-menu__item sidebar-menu__item--0
       ">
      <a href="/about/">About</a>
    </li>
     </ul>

    <ul class= "in-page-menu sidebar-menu sidebar-menu--support">

      <li class="sidebar-menu__item sidebar-menu__item--0 sidebar-contact">
        <a class="sidebar-nav-item" href="https://github.com/BardOfCodes" target="_blank">
        <img src="/img/GitHub_Logo.png" class="contact">
        </a>
      </li>
      <li class="sidebar-menu__item sidebar-menu__item--0 sidebar-contact">
        <a class="sidebar-nav-item" href="https://in.linkedin.com/in/aditya-ganeshan-68341bb9" target="_blank">
          <img src="/img/Linkedin_Logo.png" class="contact">
        </a>
      </li>
      <li class="sidebar-menu__item sidebar-menu__item--0 sidebar-contact">
        <a class="sidebar-nav-item" href="https://twitter.com/SoRapterPhilo" target="_blank">
          <img src="/img/Twitter_Logo.png" class="contact">
        </a>
      </li>
    </ul>
    <p>&copy; 2017. All rights reserved.</p>
  </div>
</div>

      

    <div class="content container main-container">
      <div class="post">
  <h2 class="post-title">Image Super Resolution using CNN - in Lasagne on jupyter notebook</h2>
  <span class="post-date">25 Oct 2016</span>
  <h3 id="introduction">Introduction</h3>
<p>For my Final-Year Seminar I reviewed the paper “Image Super-Resolution Using Deep Convolutional
 Networks” and made a narrative code in jupyter notebook implementing the SRCNN. I also made a
 presentation, where I talk about the regularization theory, and this paper. My super-ambitious plan
 was to work towards extending the Regularization theory to Image Super-resolution.</p>

<p>This is a notebook on theano based Image-super resolution based on this <a href="https://arxiv.org/abs/1501.00092">paper</a>.
This implementation is based on the implementation of <a href="https://github.com/corochann">‘corochann’</a>.
The original codes of this implementation can be found <a href="https://github.com/corochann/theanonSR">here</a>.
The images used have been taken from <a href="https://github.com/jbhuang0604/SelfExSR">here</a>
This is all work of the original authors of the papers. The purpose of this notebook is only to make the process
easier to comprehend and give a toy example of how to implement it.</p>

<h3 id="introduction-to-image-super-resolution">Introduction to Image Super-Resolution</h3>

<p>Single image super-resolution (SR), which aims at recovering a high-resolution image from a
single low-resolution image, is a classical problem in computer vision. This problem is inherently
ill-posed since a multiplicity of solutions exist for any given low-resolution pixel.</p>

<p>Such a problem is typically mitigated by constraining the solution space by strong prior information.
To learn the prior,recent state-of-the-art methods mostly adopt example-based strategy. These methods
either exploit internal similarities of the same image or learn mappingfunctions from external
low- and high-resolution exemplar pairs.</p>

<p>In this paper a Deep Convolutional Neural Network has been developed to solve this problem.
The proposed Super-Resolution-convoluted-neural-network, SRCNN, has several appealing properties.
First, its structure is intentionally designed with simplicity in mind, and yet provides superior
accuracy.Secondly, with morderate numbers of filters and layers, this method achieves fast speed
for practical on-line usage even on a CPU.</p>

<h3 id="the-model">The model</h3>

<p>Consider a single low-resolution image, we first upscale it to the desired size using bicubic
interpolation, which is the only pre-processing we perform. Let us denote the interpolated
image as <script type="math/tex">Y</script>. Our goal is to recover from <script type="math/tex">Y</script> an image <script type="math/tex">F(Y)</script> that is as similaras possible
to the ground truth high-resolution image <script type="math/tex">X</script>. For the ease of presentation, we still call
<script type="math/tex">Y</script> a “low-resolution” image, although it has the same size as <script type="math/tex">X</script>. We wish to learn a
mapping <script type="math/tex">F</script>, which conceptually consists of three operations:</p>

<p>1) <b>Patch extraction and representation:</b> this operation extracts (overlapping) patches from the
low-resolution image $Y$ and represents each patch as a high-dimensional vector. These vectors
comprise a set of feature maps, of which the number equals to the dimensionality of the
vectors.</p>

<p>2) <b>Non-linear mapping:</b> this operation nonlinearly maps each high-dimensional vector
onto another high-dimensional vector. Each mapped vector is conceptually the representation
of a high-resolution patch. These vectors comprise another set of feature maps.</p>

<p>3) <b>Reconstruction:</b> This operation aggregates the above high-resolution patch-wise
representations to generate the final high-resolution image. This image is expected to be
similar to the ground truth <script type="math/tex">X</script>.</p>

<p><img src="../../img/seminar-srcnn.png" style="margin-left:auto;margin-right:auto;" /></p>

<p>This can be mathematically be represented as</p>

<p>1)</p>

<script type="math/tex; mode=display">\begin{equation}
F_1 (Y) = max(0,W_1*Y +B_1)
\end{equation}</script>

<p>where <script type="math/tex">W_1</script> and <script type="math/tex">B_1</script> represent the filters and biases respectively, and ’*’ denotes
the convolution operation. Here, <script type="math/tex">W_1</script> corresponds to <script type="math/tex">n_1</script> filters of support <script type="math/tex">c\times f_1 \times f_1</script>,
where <script type="math/tex">c</script> is the number of channels in the input image, <script type="math/tex">f_1</script> is the spatial size of a
filter.</p>

<p>2)</p>

<script type="math/tex; mode=display">\begin{equation}
F_2 (Y) = max(0,W_2*F_1(Y) +B_2)
\end{equation}</script>

<p>Here, <script type="math/tex">W_2</script> contains <script type="math/tex">n_2</script> filters of size <script type="math/tex">n_1\times f_2 \times f_2</script>, and <script type="math/tex">B_2</script> is
<script type="math/tex">n_2</script>-dimensional.</p>

<p>3)</p>

<script type="math/tex; mode=display">\begin{equation}
F(Y) = W_3*F_2(Y) +B_3
\end{equation}</script>

<p>Here <script type="math/tex">W_3</script> corresponds to <script type="math/tex">c</script> filters of a size <script type="math/tex">n_2 \times f_3\times f_3</script>, and <script type="math/tex">B_3</script>
is a <script type="math/tex">c</script>-dimensional vector.</p>

<h3 id="training">Training</h3>

<p>Learning the end-to-end mapping function <script type="math/tex">F</script> requires the estimation of network parameters <script type="math/tex">\Theta = \{ W_1;W_2;W_3;B_1;B_2;B_3\}</script>.
This is achieved through min-imizing the loss between the reconstructed images <script type="math/tex">F(Y; \Theta)</script>
and the corresponding ground truth high-resolution images <script type="math/tex">X</script>. Given a set of high-resolution
images <script type="math/tex">\{Xi\}</script> and their corresponding low-resolution images <script type="math/tex">\{Yi\}</script>, we use Mean Squared
Error (MSE) as the loss function:</p>

<script type="math/tex; mode=display">\begin{equation}
L(\Theta) = \frac{1}{n} \sum_{i=1}^{n}{ {|| F(Y_i,\Theta) - X_i ||}^2},
\end{equation}</script>

<p>where <script type="math/tex">n</script> is the number of training samples</p>

<h3 id="links">Links</h3>

<p>The code for simulation of the solution has been written in python.You can,</p>

<ul>
  <li>
    <p>Download the code from <a href="https://github.com/BardOfCodes/SRCNN-Lasagne-Jupyter-Noteboo">here</a></p>
  </li>
  <li>
    <p>Download the Presentation PDF <a href="../../pdf/seminar-srcnn.pdf">here</a></p>
  </li>
  <li>
    <p>View the Latex files <a href="https://www.overleaf.com/read/wtrfhfgykrbf">here</a></p>
  </li>
</ul>

</div>
<!--
<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
  </ul>
</div>
-->

    </div>

  </body>
</html>
